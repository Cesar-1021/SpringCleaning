<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Room</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        body {
            margin: 0;
            overflow: hidden;
        }

        canvas {
            display: block;
        }

        #quit {
            display: block;
            position: fixed;
            top: 88%;
            left: 50%;
            transform: translate(-50%);
            padding: 2vmin;
            font-size: 3vmin;
            color: white;
            background-color: black;
            border: none;
            border-radius: 3vmin;
            cursor: pointer;
            z-index: 1000;
        }

        #quit:hover {
            background-color: pink;
        }
    </style>
</head>

<body>
    <button id="quit">Quit</button>

    <script>
        let dusterCheck;
        if (dusterCheck === null) {
            localStorage.setItem('dusterCheck', '0');
        }
        dusterCheck = localStorage.getItem('dusterCheck');

        let hamperCheck;
        if (hamperCheck === null) {
            localStorage.setItem('hamperCheck', '0');
        }
        hamperCheck = localStorage.getItem('hamperCheck');

        let sodaCheck;
        if (sodaCheck === null) {
            localStorage.setItem('sodaCheck', '0');
        }
        sodaCheck = localStorage.getItem('sodaCheck');

        // Reset

        // localStorage.setItem('hamperCheck', '0');
        // localStorage.setItem('dusterCheck', '0');
        // localStorage.setItem('sodaCheck', '0');

        let room;
        let dustImg, dusterImg, sodaImg, recylingImg, laundryImg, hamperImg;
        let dust, duster, soda, recyling, laundry, hamper;

        let num = 4;
        let refScale;

        // Preload all images
        function preload() {
            room = loadImage('sprites/room/room.png');
            dusterImg = loadImage('sprites/room/dusterIRL.png');
            hamperImg = loadImage('sprites/room/hamperIRL.png');
            sodaImg = loadImage('sprites/room/sodaPile.png');
            recylingImg = loadImage('sprites/room/recyclingBin.png');
            laundryImg = loadImage('sprites/room/laundryPile.png');
            dustImg = loadImage('sprites/room/dust.png');
        }

        function setup() {
            refScale = Math.min(windowWidth / room.width, windowHeight / room.height);

            let canvasX = (windowWidth / 2) - (room.width / 2) * refScale;
            let canvasY = (windowHeight / 2) - (room.height / 2) * refScale;
            width = room.width * refScale;
            height = room.height * refScale;
            calculatePositions();

            canvas = createCanvas(width, height).attribute('willReadFrequently', true);
            canvas.position(canvasX, canvasY);
        }

        function windowResized() {
            refScale = Math.min(windowWidth / room.width, windowHeight / room.height);
            let canvasX = (windowWidth / 2) - (room.width / 2) * refScale;
            let canvasY = (windowHeight / 2) - (room.height / 2) * refScale;
            width = room.width * refScale;
            height = room.height * refScale;
            resizeCanvas(width, height);
            calculatePositions();
            canvas.position(canvasX, canvasY);
        }

        function calculatePositions() {
            hamper = {
                left: 50 * refScale,
                top: height - 210 * refScale,
                width: hamperImg.width / 2.2 * refScale,
                height: hamperImg.height / 2.2 * refScale
            };
            hamper.right = hamper.left + hamper.width;
            hamper.bottom = hamper.top + hamper.height;

            laundry = {
                left: 620 * refScale,
                top: height - 280 * refScale,
                width: laundryImg.width / 2.5 * refScale,
                height: laundryImg.height / 2.5 * refScale
            };
            laundry.right = laundry.left + laundry.width;
            laundry.bottom = laundry.top + laundry.height;

            duster = {
                x: -60 * refScale,
                y: -170 * refScale,
                left: width - refScale * 150,
                right: width,
                top: height - 400 * refScale,
                bottom: height - 400 * refScale + 280 * refScale,
                width: dusterImg.width / 3.4 * refScale,
                height: dusterImg.height / 3.4 * refScale
            };

            dust = {
                left: 0,
                top: 170 * refScale,
                width: dustImg.width / 4.4 * refScale,
                height: dustImg.height / 3 * refScale
            };
            dust.right = dust.left + dust.width;
            dust.bottom = dust.top + 3 * 140 * refScale + dust.height;

            soda = {
                left: width - 450 * refScale,
                top: height - 270 * refScale,
                width: sodaImg.width / 3.5 * refScale,
                height: sodaImg.height / 3.5 * refScale
            };
            soda.right = soda.left + soda.width;
            soda.bottom = soda.top + soda.height;

            recyling = {
                left: 420 * refScale,
                top: 510 * refScale,
                width: recylingImg.width / 4.8 * refScale,
                height: recylingImg.height / 4.8 * refScale
            };
            recyling.right = recyling.left + recyling.width;
            recyling.bottom = recyling.top + recyling.height;

        }

        function draw() {
            clear();
            background(room); // set the background every frame

            let mouseOverDuster = mouseX >= duster.left && mouseX <= duster.right && mouseY >= duster.top && mouseY <= duster.bottom;
            let mouseOverDust = mouseX >= dust.left && mouseX <= dust.right && mouseY >= dust.top && mouseY <= dust.bottom;
            let mouseOverHamper = mouseX >= hamper.left && mouseX <= hamper.right && mouseY >= hamper.top && mouseY <= hamper.bottom;
            let mouseOverLaundry = mouseX >= laundry.left && mouseX <= laundry.right && mouseY >= laundry.top && mouseY <= laundry.bottom;
            let mouseOverSoda = mouseX >= soda.left && mouseX <= soda.right && mouseY >= soda.top && mouseY <= soda.bottom;
            let mouseOverRecycling = mouseX >= recyling.left && mouseX <= recyling.right && mouseY >= recyling.top && mouseY <= recyling.bottom;

            if (dusterCheck != '2') {
                if (dusterCheck === '0') {
                    if (mouseX >= duster.left && mouseX <= duster.right && mouseY >= duster.top && mouseY <= duster.bottom) {
                        tint(192, 255, 172);
                    }
                    // Transformations and drawing scaled images
                    push();
                    translate(width / 2 + 680 * refScale, height / 2 + 180 * refScale);
                    rotate(PI * 1.1);
                    image(dusterImg, duster.x, duster.y, duster.width, duster.height);
                    pop();
                    // square(width - refScale * 150, height - 700 * refScale, 150 * refScale);
                    tint('none');
                }
                if (mouseX >= dust.left && mouseX <= dust.right && mouseY >= dust.top && mouseY <= dust.bottom) {
                    tint(192, 255, 172);
                }
                for (let i = 0; i < num; i++) {
                    image(dustImg, -5, dust.top + i * 140 * refScale, dust.width, dust.height);
                }
                tint('none');
            }

            if (sodaCheck != '2') {
                if (sodaCheck === '0') {
                    if (mouseX >= recyling.left && mouseX <= recyling.right && mouseY >= recyling.top && mouseY <= recyling.bottom) {
                        tint(192, 255, 172);
                    }
                    image(recylingImg, recyling.left, recyling.top, recyling.width, recyling.height);
                }
                tint('none');
                if (mouseX >= soda.left && mouseX <= soda.right && mouseY >= soda.top && mouseY <= soda.bottom) {
                    tint(192, 255, 172);
                }
                image(sodaImg, soda.left, soda.top, soda.width, soda.height);
                tint('none');
            }

            if (hamperCheck != '2') {
                if (hamperCheck === '0') {
                    if (mouseX >= hamper.left && mouseX <= hamper.right && mouseY >= hamper.top && mouseY <= hamper.bottom) {
                        tint(192, 255, 172);
                    }
                    image(hamperImg, hamper.left, hamper.top, hamper.width, hamper.height);
                }
                tint('none');
                if (mouseX >= laundry.left && mouseX <= laundry.right && mouseY >= laundry.top && mouseY <= laundry.bottom) {
                    tint(192, 255, 172);
                }
                image(laundryImg, laundry.left, laundry.top, laundry.width, laundry.height);
                tint('none');
            }

            // Set cursor to hand when over an object in the room
            cursor(mouseOverDust && dusterCheck != '2' ||
                mouseOverDuster && dusterCheck === '0' ||
                mouseOverLaundry && hamperCheck != '2' ||
                mouseOverHamper && hamperCheck === '0' ||
                mouseOverSoda && sodaCheck != '2' ||
                mouseOverRecycling && sodaCheck === '0' ? HAND : ARROW);
        }

        function mouseClicked() {
            if (dusterCheck != '2') {
                if (mouseX >= dust.left && mouseX <= dust.right && mouseY >= dust.top && mouseY <= dust.bottom) {
                    window.location.href = 'dust.html';
                }
            }
            if (dusterCheck === '0') {
                if (mouseX >= duster.left && mouseX <= duster.right && mouseY >= duster.top && mouseY <= duster.bottom) {
                    window.location.href = 'duster.html';
                }
            }

            if (hamperCheck != '2') {
                if (mouseX >= laundry.left && mouseX <= laundry.right && mouseY >= laundry.top && mouseY <= laundry.bottom) {
                    window.location.href = 'laundry.html';
                }
            }
            if (hamperCheck === '0') {
                if (mouseX >= hamper.left && mouseX <= hamper.right && mouseY >= hamper.top && mouseY <= hamper.bottom) {
                    window.location.href = 'hamper.html';
                }
            }

            if (sodaCheck != '2') {
                if (mouseX >= soda.left && mouseX <= soda.right && mouseY >= soda.top && mouseY <= soda.bottom) {
                    window.location.href = 'soda.html';
                }
            }

            if (sodaCheck === '0') {
                if (mouseX >= recyling.left && mouseX <= recyling.right && mouseY >= recyling.top && mouseY <= recyling.bottom) {
                    window.location.href = 'recycling.html';
                }
            }
        }

        document.addEventListener("DOMContentLoaded", function () {
            var quitButton = document.getElementById('quit');
            quitButton.addEventListener('click', function () {
                localStorage.setItem('hamperCheck', '0');
                localStorage.setItem('dusterCheck', '0');
                localStorage.setItem('sodaCheck', '0');
                window.location.href = 'index.html';
            });
        });
    </script>
</body>

</html>